
# Markdown Memo App - 標準技術スタックサンプル

このリポジトリは、標準的な技術スタックを用いたWebアプリケーションのサンプル実装です。
開発のベースラインとして利用することを目的としています。

## 設計思想

このサンプル実装で最も重要視しているのは、**型安全性**と**SOLID原則**です。これらは、堅牢で保守性が高く、スケールしやすいアプリケーションを構築するための基盤となります。

### 基本言語

開発の基本言語は **TypeScript** です。静的型付けの恩恵を最大限に活用し、コードの品質と開発効率を高めます。

### アーキテクチャと技術スタックの柔軟性

- **アーキテクチャ**: クリーンアーキテクチャの概念を取り入れていますが、その適用度はプロジェクトの規模や複雑さに応じて柔軟に判断してください。小規模なプロジェクトで厳密に適用すると、かえって過剰設計になる可能性があります。
- **技術スタック**: このリポジトリで使用されている技術（Next.js, Hono, Drizzle ORMなど）はあくまで一例です。プロジェクトの要件やチームのスキルセットに応じて、最適なものを自由に選択・変更してください。

### 状態を持たないモジュールの設計

特定の計算処理やデータ変換など、アプリケーションの状態（データベースなど）に依存しない独立した機能を持つモジュールについては、必ずしもTypeScriptで実装する必要はありません。要件に応じて最適な言語やライブラリを選択してください。

重要なのは、これらのモジュールを**状態から分離し、単体で完結するように設計する**ことです。これにより、モジュールの再利用性が高まり、テストも容易になります。

## フォルダ構成と設計

このプロジェクトでは、フロントエンドとバックエンドを明確に分離しています。

ここで示されているフォルダ構成はあくまで一例です。プロジェクトの規模やチームの人数に応じて、より最適な構成を選択してください。例えば、機能が複雑化していく場合は、現在のレイヤー別（`routes`, `services`）の構成よりも、ドメイン別（例: `src/memo`, `src/user`）にフォルダを分ける方が見通しが良くなる場合もあります。

### `server/` (バックエンド)

クリーンアーキテクチャの思想に基づき、関心を分離することを目的としたフォルダ構成です。

- `src/routes`: APIのエンドポイントを定義します。
- `src/services`: アプリケーションのユースケースを実装します。ビジネスロジックの関心事はこの層に集約されます。
- `src/repositories`: データベースとのやり取りを抽象化する層です。データの永続化に関するロジックを担当します。
- `src/db`: Drizzle ORMのスキーマ定義やマイグレーションファイルを配置します。

依存関係は常に一方向（`routes` → `services` → `repositories`）を保ち、関心事が外部に漏れ出さないように設計されています。依存性の注入（DI）には`InversifyJS`を利用し、コンポーネント間の結合度を低く保っています。

### `frontend/` (フロントエンド)

Next.js (App Router) の標準的な構成をベースに、バックエンドと同様に責務を分離する設計を取り入れています。

- `app`: Next.jsのApp Routerに基づいたルーティングと、各ページのコンポーネントです。
- `components`: アプリケーション全体で再利用可能なUIコンポーネントを配置します。
- `services`: バックエンドAPIとの通信や、フロントエンド固有のビジネスロジックをカプセル化します。Factoryパターンを用いて、インターフェースと具象実装を分離しており、テストやモックへの差し替えが容易になっています。
- `lib`: 汎用的なヘルパー関数や、外部ライブラリのクライアント設定などを配置します。
- `contexts`: React Context APIを用いたグローバルな状態管理を行います。

## テスト

エンドポイント、ユースケース層、サービス層は、それぞれがアトミックな操作（一連の処理がすべて成功するか、すべて失敗するかのどちらかであること）を保証するように実装されています。

インテグレーションテストを記述する際には、この**アトミック性を検証するテストケースを必ず含める**ようにしてください。

## 使用技術スタック

このサンプルでは、以下の技術スタックを採用しています。

- **フロントエンド**: [Next.js](https://nextjs.org/) (React)
- **バックエンド**: [Hono](https://hono.dev/)
- **データベース**: [Turso](https://turso.tech/) (libSQL)
- **ORM**: [Drizzle ORM](https://orm.drizzle.team/)
- **UIコンポーネント**: [shadcn/ui](https://ui.shadcn.com/)

---

## 開発環境のセットアップ

### フロントエンド

```shell
$ cd frontend
$ pnpm install
$ pnpm dev
```

### バックエンド

```shell
$ cd server
$ pnpm install
$ pnpm db:setup
```

NextJS に Hono をマウントしたので、 `pnpm dev` で hono server を立ち上げる必要はありません。
ブラウザで、`http://localhost:3000/memos` を開いてください。

### バックエンド